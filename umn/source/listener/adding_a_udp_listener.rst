:original_name: elb_ug_jt_0007.html

.. _elb_ug_jt_0007:

Adding a UDP Listener
=====================

Scenarios
---------

UDP listeners are suitable for scenarios that focus more on timeliness than reliability, such as video chat, gaming, and real-time quotation in the financial market.

.. caution::

   -  UDP listeners do not support fragmentation.
   -  The port of UDP listeners cannot be 4789.
   -  Dedicated load balancers: The backend protocol can be UDP or QUIC.
   -  Shared load balancers: If the listener's protocol is UDP, the protocol of the backend server group is UDP by default and cannot be changed.
   -  If a dedicated load balancer uses a specification for application load balancing (HTTP/HTTPS), you cannot create a UDP listener.

Adding a UDP Listener to a Dedicated Load Balancer
--------------------------------------------------

#. Log in to the management console.

#. In the upper left corner of the page, click |image1| and select the desired region and project.

#. Hover on |image2| in the upper left corner to display **Service List** and choose **Network** > **Elastic Load Balancing**.

#. Locate the load balancer and click its name.

#. Under **Listeners**, click **Add Listener**. Configure the parameters based on :ref:`Table 1 <elb_ug_jt_0007__table16995152202318>`.

   .. _elb_ug_jt_0007__table16995152202318:

   .. table:: **Table 1** Parameters for configuring a listener

      +----------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Parameter                  | Description                                                                                                                                                                                                                             | Example Value         |
      +============================+=========================================================================================================================================================================================================================================+=======================+
      | Name                       | Specifies the listener name.                                                                                                                                                                                                            | listener-pnqy         |
      +----------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Frontend Protocol          | Specifies the protocol that will be used by the load balancer to receive requests from clients.                                                                                                                                         | UDP                   |
      +----------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Frontend Port              | Specifies the port that will be used by the load balancer to receive requests from clients.                                                                                                                                             | 80                    |
      |                            |                                                                                                                                                                                                                                         |                       |
      |                            | The port number ranges from 1 to 65535.                                                                                                                                                                                                 |                       |
      +----------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | **Advanced Settings**      |                                                                                                                                                                                                                                         |                       |
      +----------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Access Policy              | Specifies how access to the listener is controlled. The following options are available (for details, see :ref:`Access Control <en-us_elb_03_0003>`):                                                                                   | **Blacklist**         |
      |                            |                                                                                                                                                                                                                                         |                       |
      |                            | -  **All IP addresses**                                                                                                                                                                                                                 |                       |
      |                            | -  **Blacklist**                                                                                                                                                                                                                        |                       |
      |                            | -  **Whitelist**                                                                                                                                                                                                                        |                       |
      +----------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | IP Address Group           | Specifies the IP address group associated with a whitelist or blacklist. If there is no IP address group, create one first. For more information, see :ref:`IP Address Group (Whitelist or Blacklist) <elb_ug_ip_0000>`.                | ipGroup-b2            |
      +----------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Transfer Client IP Address | Specifies whether to transmit IP addresses of the clients to backend servers.                                                                                                                                                           | N/A                   |
      |                            |                                                                                                                                                                                                                                         |                       |
      |                            | This function is enabled for dedicated load balancers by default and cannot be disabled.                                                                                                                                                |                       |
      +----------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Idle Timeout               | Specifies the length of time for a connection to keep alive, in seconds. If no request is received within this period, the load balancer closes the connection and establishes a new one with the client when the next request arrives. | 300                   |
      |                            |                                                                                                                                                                                                                                         |                       |
      |                            | The idle timeout duration ranges from **10** to **4000**.                                                                                                                                                                               |                       |
      +----------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Tag                        | Adds tags to the listener. Each tag is a key-value pair, and the tag key is unique.                                                                                                                                                     | ``-``                 |
      +----------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Description                | Provides supplementary information about the listener.                                                                                                                                                                                  | N/A                   |
      |                            |                                                                                                                                                                                                                                         |                       |
      |                            | You can enter a maximum of 255 characters.                                                                                                                                                                                              |                       |
      +----------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+

#. Click **Next: Configure Request Routing Policy**. :ref:`Table 2 <elb_ug_jt_0007__table299811529239>` describes the parameters for configuring a backend server group.

   .. _elb_ug_jt_0007__table299811529239:

   .. table:: **Table 2** Parameters for configuring a backend server group

      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Parameter                 | Description                                                                                                                                                                                                                                                                                                                                                                                                                                | Example Value         |
      +===========================+============================================================================================================================================================================================================================================================================================================================================================================================================================================+=======================+
      | Backend Server Group      | Specifies a group of servers with the same features to receive requests from the load balancer. Two options are available:                                                                                                                                                                                                                                                                                                                 | Create new            |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | -  **Create new**                                                                                                                                                                                                                                                                                                                                                                                                                          |                       |
      |                           | -  **Use existing**                                                                                                                                                                                                                                                                                                                                                                                                                        |                       |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           |    .. note::                                                                                                                                                                                                                                                                                                                                                                                                                               |                       |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           |       To associate an existing backend server group, ensure that it is not in use. Select the backend server group with the correct protocol. For example, if the frontend protocol is TCP, the backend protocol can only be TCP.                                                                                                                                                                                                          |                       |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Name                      | Specifies the name of the backend server group.                                                                                                                                                                                                                                                                                                                                                                                            | server_group-sq4v     |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Backend Protocol          | Specifies the protocol that will be used by backend servers to receive requests.                                                                                                                                                                                                                                                                                                                                                           | UDP                   |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | The backend protocol can be UDP or QUIC.                                                                                                                                                                                                                                                                                                                                                                                                   |                       |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Load Balancing Algorithm  | Specifies the algorithm that will be used by the load balancer to distribute traffic. The following options are available:                                                                                                                                                                                                                                                                                                                 | Weighted round robin  |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | -  **Weighted round robin**: Requests are routed to different servers based on their weights, which indicate server processing performance. Backend servers with higher weights receive proportionately more requests, whereas equal-weighted servers receive the same number of requests.                                                                                                                                                 |                       |
      |                           | -  **Weighted least connections**: In addition to the number of active connections established with each backend server, each server is assigned a weight based on their processing capability. Requests are routed to the server with the lowest connections-to-weight ratio.                                                                                                                                                             |                       |
      |                           | -  **Source IP hash**: The source IP address of each request is calculated using the consistent hashing algorithm to obtain a unique hash key, and all backend servers are numbered. The generated key is used to allocate the client to a particular server. This allows requests from different clients to be routed based on source IP addresses and ensures that a client is directed to the same server that it was using previously. |                       |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | .. note::                                                                                                                                                                                                                                                                                                                                                                                                                                  |                       |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           |    -  Choose an appropriate algorithm based on your requirements for better traffic distribution.                                                                                                                                                                                                                                                                                                                                          |                       |
      |                           |    -  For **Weighted round robin** or **Weighted least connections**, no requests will be routed to a server with a weight of 0.                                                                                                                                                                                                                                                                                                           |                       |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Sticky Session            | Specifies whether to enable sticky sessions. If you enable sticky sessions, all requests from a client during one session are sent to the same backend server.                                                                                                                                                                                                                                                                             | N/A                   |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | .. note::                                                                                                                                                                                                                                                                                                                                                                                                                                  |                       |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           |    You can enable sticky sessions only if you select **Weighted round robin** for **Load Balancing Algorithm**.                                                                                                                                                                                                                                                                                                                            |                       |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Sticky Session Type       | Specifies the type of sticky sessions. **Source IP address** is the only choice available when TCP or UDP is used as the frontend protocol.                                                                                                                                                                                                                                                                                                | Source IP address     |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | **Source IP address**: The source IP address of each request is calculated using the consistent hashing algorithm to obtain a unique hash key, and all backend servers are numbered. The system allocates the client to a particular server based on the generated key. This enables requests from different clients to be routed and ensures that a client is directed to the same server that it was using previously.                   |                       |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Stickiness Duration (min) | Specifies the minutes that sticky sessions are maintained. You can enable sticky sessions only if you select **Weighted round robin** for **Load Balancing Algorithm**.                                                                                                                                                                                                                                                                    | 20                    |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | -  Stickiness duration at Layer 4: **1** to **60**                                                                                                                                                                                                                                                                                                                                                                                         |                       |
      |                           | -  Stickiness duration at Layer 7: **1** to **1440**                                                                                                                                                                                                                                                                                                                                                                                       |                       |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Description               | Provides supplementary information about the backend server group.                                                                                                                                                                                                                                                                                                                                                                         | N/A                   |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | You can enter a maximum of 255 characters.                                                                                                                                                                                                                                                                                                                                                                                                 |                       |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+

#. Click **Next: Add Backend Server**. Add backend servers and configure the health check for the backend server group. For details about how to add backend servers, see :ref:`Adding or Removing Backend Servers (Dedicated Load Balancers) <elb_ug_hd_0003>`. For details about how to configure health check parameters, see :ref:`Table 3 <elb_ug_jt_0007__table752815564231>`.

   .. _elb_ug_jt_0007__table752815564231:

   .. table:: **Table 3** Parameters for configuring a health check

      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Parameter             | Description                                                                                                                                                                                                 | Example Value         |
      +=======================+=============================================================================================================================================================================================================+=======================+
      | Health Check          | Specifies whether to enable health checks.                                                                                                                                                                  | N/A                   |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Protocol              | Specifies the protocol that will be used by the load balancer to check the health of backend servers. The health check protocol is UDP by default and cannot be changed.                                    | UDP                   |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Port                  | Specifies the port that will be used by the load balancer to check the health of backend servers. The port number ranges from 1 to 65535.                                                                   | 80                    |
      |                       |                                                                                                                                                                                                             |                       |
      |                       | .. note::                                                                                                                                                                                                   |                       |
      |                       |                                                                                                                                                                                                             |                       |
      |                       |    This parameter is optional. If you do not specify a health check port, a port of the backend server will be used for health checks by default. If you specify a port, it will be used for health checks. |                       |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | **Advanced Settings** |                                                                                                                                                                                                             |                       |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Interval (s)          | Specifies the maximum time between two consecutive health checks, in seconds.                                                                                                                               | 5                     |
      |                       |                                                                                                                                                                                                             |                       |
      |                       | The interval ranges from **1** to **50**.                                                                                                                                                                   |                       |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Timeout (s)           | Specifies the maximum time required for waiting for a response from the health check, in seconds. The timeout duration ranges from **1** to **50**.                                                         | 3                     |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Maximum Retries       | Specifies the maximum number of health check retries. The value ranges from **1** to **10**.                                                                                                                | 3                     |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+

#. Click **Next: Confirm**.

#. Confirm the configuration and click **Submit**.

Adding a UDP Listener to a Shared Load Balancer
-----------------------------------------------

#. Log in to the management console.

#. In the upper left corner of the page, click |image3| and select the desired region and project.

#. Hover on |image4| in the upper left corner to display **Service List** and choose **Network** > **Elastic Load Balancing**.

#. Locate the load balancer and click its name.

#. Under **Listeners**, click **Add Listener**. Configure the parameters based on :ref:`Table 4 <elb_ug_jt_0007__table20377204713512>`.

   .. _elb_ug_jt_0007__table20377204713512:

   .. table:: **Table 4** Parameters for configuring a listener

      +----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Parameter                  | Description                                                                                                                                                                                                              | Example Value         |
      +============================+==========================================================================================================================================================================================================================+=======================+
      | Name                       | Specifies the listener name.                                                                                                                                                                                             | listener-pnqy         |
      +----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Frontend Protocol          | Specifies the protocol that will be used by the load balancer to receive requests from clients.                                                                                                                          | UDP                   |
      +----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Frontend Port              | Specifies the port that will be used by the load balancer to receive requests from clients.                                                                                                                              | 80                    |
      |                            |                                                                                                                                                                                                                          |                       |
      |                            | The port number ranges from 1 to 65535.                                                                                                                                                                                  |                       |
      +----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | **Advanced Settings**      |                                                                                                                                                                                                                          |                       |
      +----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Access Control             | Specifies how access to the listener is controlled. The following options are available (for details, see :ref:`Access Control <en-us_elb_03_0003>`):                                                                    | Whitelist             |
      |                            |                                                                                                                                                                                                                          |                       |
      |                            | -  **All IP addresses**                                                                                                                                                                                                  |                       |
      |                            | -  **Blacklist**                                                                                                                                                                                                         |                       |
      |                            | -  **Whitelist**                                                                                                                                                                                                         |                       |
      +----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | IP Address Group           | Specifies the IP address group associated with a whitelist or blacklist. If there is no IP address group, create one first. For more information, see :ref:`IP Address Group (Whitelist or Blacklist) <elb_ug_ip_0000>`. | ipGroup-b2            |
      +----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Transfer Client IP Address | Specifies whether to transmit IP addresses of the clients to backend servers.                                                                                                                                            | N/A                   |
      +----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Tag                        | Adds tags to the listener. Each tag is a key-value pair, and the tag key is unique.                                                                                                                                      | ``-``                 |
      +----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Description                | Provides supplementary information about the listener.                                                                                                                                                                   | N/A                   |
      |                            |                                                                                                                                                                                                                          |                       |
      |                            | You can enter a maximum of 255 characters.                                                                                                                                                                               |                       |
      +----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+

#. Click **Next: Configure Request Routing Policy**. :ref:`Table 5 <elb_ug_jt_0007__table3561446373>` describes the parameters for configuring a backend server group.

   .. _elb_ug_jt_0007__table3561446373:

   .. table:: **Table 5** Parameters for configuring a backend server group

      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Parameter                 | Description                                                                                                                                                                                                                                                                                                                                                                                                                                | Example Value         |
      +===========================+============================================================================================================================================================================================================================================================================================================================================================================================================================================+=======================+
      | Backend Server Group      | Specifies a group of servers with the same features to receive requests from the load balancer. Two options are available:                                                                                                                                                                                                                                                                                                                 | **Create new**        |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | -  **Create new**                                                                                                                                                                                                                                                                                                                                                                                                                          |                       |
      |                           | -  **Use existing**                                                                                                                                                                                                                                                                                                                                                                                                                        |                       |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           |    .. note::                                                                                                                                                                                                                                                                                                                                                                                                                               |                       |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           |       To associate an existing backend server group, ensure that it is not in use. Select the backend server group with the correct protocol. For example, if the frontend protocol is TCP, the backend protocol can only be TCP.                                                                                                                                                                                                          |                       |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Name                      | Specifies the name of the backend server group.                                                                                                                                                                                                                                                                                                                                                                                            | server_group-sq4v     |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Backend Protocol          | Specifies the protocol that will be used by backend servers to receive requests.                                                                                                                                                                                                                                                                                                                                                           | UDP                   |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | The backend protocol is UDP by default and cannot be changed.                                                                                                                                                                                                                                                                                                                                                                              |                       |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Load Balancing Algorithm  | Specifies the algorithm used by the load balancer to distribute traffic. The following options are available:                                                                                                                                                                                                                                                                                                                              | Weighted round robin  |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | -  **Weighted round robin**: Requests are routed to different servers based on their weights, which indicate server processing performance. Backend servers with higher weights receive proportionately more requests, whereas equal-weighted servers receive the same number of requests.                                                                                                                                                 |                       |
      |                           | -  **Weighted least connections**: In addition to the number of active connections established with each backend server, each server is assigned a weight based on their processing capability. Requests are routed to the server with the lowest connections-to-weight ratio.                                                                                                                                                             |                       |
      |                           | -  **Source IP hash**: The source IP address of each request is calculated using the consistent hashing algorithm to obtain a unique hash key, and all backend servers are numbered. The generated key is used to allocate the client to a particular server. This allows requests from different clients to be routed based on source IP addresses and ensures that a client is directed to the same server that it was using previously. |                       |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | .. note::                                                                                                                                                                                                                                                                                                                                                                                                                                  |                       |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           |    -  Choose an appropriate algorithm based on your requirements for better traffic distribution.                                                                                                                                                                                                                                                                                                                                          |                       |
      |                           |    -  For **Weighted round robin** or **Weighted least connections**, no requests will be routed to a server with a weight of 0.                                                                                                                                                                                                                                                                                                           |                       |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Sticky Session            | Specifies whether to enable sticky sessions. If you enable sticky sessions, all requests from a client during one session are sent to the same backend server.                                                                                                                                                                                                                                                                             | N/A                   |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | .. note::                                                                                                                                                                                                                                                                                                                                                                                                                                  |                       |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           |    You can enable sticky sessions only if you select **Weighted round robin** for **Load Balancing Algorithm**.                                                                                                                                                                                                                                                                                                                            |                       |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Sticky Session Type       | Specifies the type of sticky sessions. **Source IP address** is the only choice available when TCP or UDP is used as the frontend protocol.                                                                                                                                                                                                                                                                                                | Source IP address     |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | **Source IP address**: The source IP address of each request is calculated using the consistent hashing algorithm to obtain a unique hash key, and all backend servers are numbered. The system allocates the client to a particular server based on the generated key. This enables requests from different clients to be routed and ensures that a client is directed to the same server that it was using previously.                   |                       |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Stickiness Duration (min) | Specifies the minutes that sticky sessions are maintained. You can enable sticky sessions only if you select **Weighted round robin** for **Load Balancing Algorithm**.                                                                                                                                                                                                                                                                    | 20                    |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | -  Stickiness duration at Layer 4: **1** to **60**                                                                                                                                                                                                                                                                                                                                                                                         |                       |
      |                           | -  Stickiness duration at Layer 7: **1** to **1440**                                                                                                                                                                                                                                                                                                                                                                                       |                       |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Description               | Provides supplementary information about the backend server group.                                                                                                                                                                                                                                                                                                                                                                         | N/A                   |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | You can enter a maximum of 255 characters.                                                                                                                                                                                                                                                                                                                                                                                                 |                       |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+

#. Click **Next: Add Backend Server**. Add backend servers and configure the health check for the backend server group. For details about how to add backend servers, see :ref:`Adding or Removing Backend Servers (Shared Load Balancers) <en-us_topic_0052569729>`. For details about how to configure health check parameters, see :ref:`Table 6 <elb_ug_jt_0007__table514610499101>`.

   .. _elb_ug_jt_0007__table514610499101:

   .. table:: **Table 6** Parameters for configuring a health check

      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Parameter             | Description                                                                                                                                                                                                 | Example Value         |
      +=======================+=============================================================================================================================================================================================================+=======================+
      | Health Check          | Specifies whether to enable health checks.                                                                                                                                                                  | N/A                   |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Protocol              | Specifies the protocol that will be used by the load balancer to check the health of backend servers. The health check protocol is UDP by default and cannot be changed.                                    | UDP                   |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Port                  | Specifies the port that will be used by the load balancer to check the health of backend servers. The port number ranges from 1 to 65535.                                                                   | 80                    |
      |                       |                                                                                                                                                                                                             |                       |
      |                       | .. note::                                                                                                                                                                                                   |                       |
      |                       |                                                                                                                                                                                                             |                       |
      |                       |    This parameter is optional. If you do not specify a health check port, a port of the backend server will be used for health checks by default. If you specify a port, it will be used for health checks. |                       |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | **Advanced Settings** |                                                                                                                                                                                                             |                       |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Interval (s)          | Specifies the maximum time between two consecutive health checks, in seconds.                                                                                                                               | 5                     |
      |                       |                                                                                                                                                                                                             |                       |
      |                       | The interval ranges from **1** to **50**.                                                                                                                                                                   |                       |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Timeout (s)           | Specifies the maximum time required for waiting for a response from the health check, in seconds. The timeout duration ranges from **1** to **50**.                                                         | 3                     |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Maximum Retries       | Specifies the maximum number of health check retries. The value ranges from **1** to **10**.                                                                                                                | 3                     |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+

#. Click **Next: Confirm**.

#. Confirm the configuration and click **Submit**.

.. |image1| image:: /_static/images/en-us_image_0000001211126503.png
.. |image2| image:: /_static/images/en-us_image_0000001417088430.png
.. |image3| image:: /_static/images/en-us_image_0000001211126503.png
.. |image4| image:: /_static/images/en-us_image_0000001417088430.png
