:original_name: elb_ug_hdg_0003.html

.. _elb_ug_hdg_0003:

Creating a Backend Server Group (Dedicated Load Balancers)
==========================================================

Scenario
--------

To route requests, you need to associate a backend server group to each listener.

.. note::

   This section describes how you can create a backend server group for a dedicated load balancer.

You can create a backend server group for a load balancer in any of the ways described in :ref:`Table 1 <elb_ug_hdg_0003__table15450757191418>`.

.. _elb_ug_hdg_0003__table15450757191418:

.. table:: **Table 1** Creating a backend server group

   +-------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------+
   | Scenario                                                                | Procedure                                                                                                       |
   +=========================================================================+=================================================================================================================+
   | Creating a backend server group and associating it with a load balancer | :ref:`Procedure <elb_ug_hdg_0003__en-us_topic_0000001383606924_section92351821132217>`                          |
   +-------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------+
   | Creating a backend server group when adding a listener                  | You can add listeners using different protocols as required. For details, see :ref:`Overview <elb_ug_jt_0001>`. |
   |                                                                         |                                                                                                                 |
   |                                                                         | References are as follows:                                                                                      |
   |                                                                         |                                                                                                                 |
   |                                                                         | -  :ref:`Adding a TCP Listener <elb_ug_jt_0006>`                                                                |
   |                                                                         | -  :ref:`Adding a UDP Listener <elb_ug_jt_0007>`                                                                |
   |                                                                         | -  :ref:`Adding an HTTP Listener <elb_ug_jt_0008>`                                                              |
   |                                                                         | -  :ref:`Adding an HTTPS Listener <elb_ug_jt_0009>`                                                             |
   +-------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------+
   | Changing the backend server group associated with the listener          | :ref:`Changing a Backend Server Group <elb_ug_hdg_0006>`                                                        |
   +-------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------+

Constraints
-----------

The backend protocol of the new backend server group must match the frontend protocol of the listener as described in :ref:`Table 2 <elb_ug_hdg_0003__table1910201010113>`.

.. _elb_ug_hdg_0003__table1910201010113:

.. table:: **Table 2** The frontend and backend protocols

   +-----------------------------------+-----------------------------------+
   | Frontend Protocol                 | Backend Protocol                  |
   +===================================+===================================+
   | TCP                               | TCP                               |
   +-----------------------------------+-----------------------------------+
   | UDP                               | -  UDP                            |
   |                                   | -  QUIC                           |
   +-----------------------------------+-----------------------------------+
   | HTTP                              | HTTP                              |
   +-----------------------------------+-----------------------------------+
   | HTTPS                             | -  HTTP                           |
   |                                   | -  HTTPS                          |
   +-----------------------------------+-----------------------------------+

.. _elb_ug_hdg_0003__en-us_topic_0000001383606924_section92351821132217:

Procedure
---------

#. Log in to the management console.

#. In the upper left corner of the page, click |image1| and select the desired region and project.

#. Click |image2| in the upper left corner to display **Service List** and choose **Network** > **Elastic Load Balancing**.

#. In the navigation pane on the left, choose **Elastic Load Balancing** > **Backend Server Groups**.

#. Click **Create Backend Server Group** in the upper right corner.

#. Configure the routing policy based on :ref:`Table 3 <elb_ug_hdg_0003__table17921104011492>`.

   .. _elb_ug_hdg_0003__table17921104011492:

   .. table:: **Table 3** Parameters required for configuring a routing policy

      +---------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Parameter                 | Description                                                                                                                                                                                                                                                                                                                                                           | Example Value         |
      +===========================+=======================================================================================================================================================================================================================================================================================================================================================================+=======================+
      | Load Balancing Type       | Specifies the type of load balancers that can use the backend server group. Dedicated load balancers are recommended.                                                                                                                                                                                                                                                 | ``-``                 |
      |                           |                                                                                                                                                                                                                                                                                                                                                                       |                       |
      |                           | The following parameters apply to exclusive load balancers.                                                                                                                                                                                                                                                                                                           |                       |
      +---------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Load Balancer             | Specifies whether to associate a load balancer.                                                                                                                                                                                                                                                                                                                       | ``-``                 |
      +---------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Backend Server Group Name | Specifies the name of the backend server group.                                                                                                                                                                                                                                                                                                                       | server_group          |
      +---------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Backend Protocol          | Specifies the protocol that backend servers in the backend server group use to receive requests from the listeners. The protocol varies depending on the forwarding mode:                                                                                                                                                                                             | HTTP                  |
      |                           |                                                                                                                                                                                                                                                                                                                                                                       |                       |
      |                           | The options are HTTP, HTTPS, TCP, UDP, and QUIC.                                                                                                                                                                                                                                                                                                                      |                       |
      +---------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Load Balancing Algorithm  | Specifies the algorithm used by the load balancer to distribute traffic. The following options are available:                                                                                                                                                                                                                                                         | Weighted round robin  |
      |                           |                                                                                                                                                                                                                                                                                                                                                                       |                       |
      |                           | -  **Weighted round robin**: Requests are routed to different servers based on their weights. Backend servers with higher weights receive proportionately more requests, whereas equal-weighted servers receive the same number of requests.                                                                                                                          |                       |
      |                           | -  **Weighted least connections**: In addition to the number of connections, each server is assigned a weight based on its capacity. Requests are routed to the server with the lowest connections-to-weight ratio.                                                                                                                                                   |                       |
      |                           | -  **Source IP hash**: Allows requests from different clients to be routed based on source IP addresses and ensures that requests from the same client are forwarded to the same server.                                                                                                                                                                              |                       |
      |                           | -  **Connection ID**: This algorithm is available when you have selected **QUIC** for **Backend Protocol**. This algorithm allows requests with different connection IDs to be routed to different backend servers and ensures that requests with the same connection ID are routed to the same backend server.                                                       |                       |
      |                           |                                                                                                                                                                                                                                                                                                                                                                       |                       |
      |                           | For more information about load balancing algorithms, see :ref:`Load Balancing Algorithms <elb_ug_jt_0003>`.                                                                                                                                                                                                                                                          |                       |
      +---------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Sticky Session            | If you enable sticky sessions, all requests from the same client during one session are sent to the same backend server.                                                                                                                                                                                                                                              | ``-``                 |
      |                           |                                                                                                                                                                                                                                                                                                                                                                       |                       |
      |                           | For more information about sticky sessions, see :ref:`Sticky Session <elb_ug_jt_0004>`.                                                                                                                                                                                                                                                                               |                       |
      +---------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Sticky Session Type       | Specifies the sticky session type.                                                                                                                                                                                                                                                                                                                                    | Source IP address     |
      |                           |                                                                                                                                                                                                                                                                                                                                                                       |                       |
      |                           | This parameter is mandatory if **Sticky Session** is enabled. You can select one of the following type:                                                                                                                                                                                                                                                               |                       |
      |                           |                                                                                                                                                                                                                                                                                                                                                                       |                       |
      |                           | -  **Source IP address**: The source IP address of each request is calculated using the consistent hashing algorithm to obtain a unique hashing key, and all backend servers are numbered. The system allocates the client to a particular server based on the generated key. This allows requests from the same IP address are forwarded to the same backend server. |                       |
      |                           | -  **Load balancer cookie**: The load balancer generates a cookie after receiving a request from the client.                                                                                                                                                                                                                                                          |                       |
      |                           |                                                                                                                                                                                                                                                                                                                                                                       |                       |
      |                           | .. note::                                                                                                                                                                                                                                                                                                                                                             |                       |
      |                           |                                                                                                                                                                                                                                                                                                                                                                       |                       |
      |                           |    -  **Source IP address** is available when you have selected **TCP**, **UDP**, or **QUIC** for **Backend Protocol**.                                                                                                                                                                                                                                               |                       |
      |                           |    -  **Load balancer cookie** is available when you have selected **HTTP** or **HTTPS** for **Backend Protocol**.                                                                                                                                                                                                                                                    |                       |
      +---------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Stickiness Duration (min) | Specifies the minutes that sticky sessions are maintained. This parameter is mandatory if **Sticky Session** is enabled.                                                                                                                                                                                                                                              | 20                    |
      |                           |                                                                                                                                                                                                                                                                                                                                                                       |                       |
      |                           | -  Sticky sessions at Layer 4: **1** to **60**                                                                                                                                                                                                                                                                                                                        |                       |
      |                           | -  Sticky sessions at Layer 7: **1** to **1440**                                                                                                                                                                                                                                                                                                                      |                       |
      +---------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Slow Start                | Specifies whether to enable slow start. This parameter is optional if you have selected **Weighted round robin** for **Load Balancing Algorithm**.                                                                                                                                                                                                                    | ``-``                 |
      |                           |                                                                                                                                                                                                                                                                                                                                                                       |                       |
      |                           | After you enable this option, the load balancer linearly increases the proportion of requests to backend servers in this mode.                                                                                                                                                                                                                                        |                       |
      |                           |                                                                                                                                                                                                                                                                                                                                                                       |                       |
      |                           | When the slow start duration elapses, the load balancer sends full share of requests to backend servers and exits the slow start mode.                                                                                                                                                                                                                                |                       |
      |                           |                                                                                                                                                                                                                                                                                                                                                                       |                       |
      |                           | .. note::                                                                                                                                                                                                                                                                                                                                                             |                       |
      |                           |                                                                                                                                                                                                                                                                                                                                                                       |                       |
      |                           |    Slow start is only available for HTTP and HTTPS backend server groups of dedicated load balancers.                                                                                                                                                                                                                                                                 |                       |
      |                           |                                                                                                                                                                                                                                                                                                                                                                       |                       |
      |                           | For more information about the slow start, see :ref:`Slow Start (Dedicated Load Balancers) <en-us_topic_0000001794819209>`.                                                                                                                                                                                                                                           |                       |
      +---------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Slow Start Duration (s)   | Specifies how long the slow start will last, in seconds.                                                                                                                                                                                                                                                                                                              | 30                    |
      |                           |                                                                                                                                                                                                                                                                                                                                                                       |                       |
      |                           | This parameter is mandatory if **Slow Start** is enabled.                                                                                                                                                                                                                                                                                                             |                       |
      +---------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Description               | Provides supplementary information about the backend server group.                                                                                                                                                                                                                                                                                                    | ``-``                 |
      +---------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+

#. Click **Next** to add backend servers and configure health check.

   Add cloud servers, or IP addresses to this backend server group. For details, see :ref:`Overview <elb_ug_hd3_0001>`.

   Configure health check for the backend server group based on :ref:`Table 4 <elb_ug_hdg_0003__en-us_topic_0000001383606924_table11861154278>`. For more information about health checks, see :ref:`Health Check <elb_ug_hc_0001>`.

   .. _elb_ug_hdg_0003__en-us_topic_0000001383606924_table11861154278:

   .. table:: **Table 4** Parameters required for configuring a health check

      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Parameter             | Description                                                                                                                                                                                                                                     | Example Value         |
      +=======================+=================================================================================================================================================================================================================================================+=======================+
      | Health Check          | Specifies whether to enable health checks.                                                                                                                                                                                                      | ``-``                 |
      |                       |                                                                                                                                                                                                                                                 |                       |
      |                       | If the health check is enabled, click |image3| next to **Advanced Settings** to set health check parameters.                                                                                                                                    |                       |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Health Check Protocol | Specifies the protocol that will be used by the load balancer to check the health of backend servers.                                                                                                                                           | HTTP                  |
      |                       |                                                                                                                                                                                                                                                 |                       |
      |                       | -  The backend protocol can be TCP, HTTP, or HTTPS.                                                                                                                                                                                             |                       |
      |                       | -  If the protocol of the backend server group is UDP, the health check protocol is UDP by default.                                                                                                                                             |                       |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Domain Name           | Specifies the domain name that will be used for health checks.                                                                                                                                                                                  | www.elb.com           |
      |                       |                                                                                                                                                                                                                                                 |                       |
      |                       | This parameter is mandatory if the health check protocol is HTTP, HTTPS, or gRPC.                                                                                                                                                               |                       |
      |                       |                                                                                                                                                                                                                                                 |                       |
      |                       | -  You can use the private IP address of the backend server as the domain name.                                                                                                                                                                 |                       |
      |                       | -  You can also specify a domain name that consists of at least two labels separated by periods (.). Use only letters, digits, and hyphens (-). Do not start or end strings with a hyphen. Max total: 100 characters. Max label: 63 characters. |                       |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Health Check Port     | Specifies the port that will be used by the load balancer to check the health of backend servers. The port number ranges from 1 to 65535.                                                                                                       | 80                    |
      |                       |                                                                                                                                                                                                                                                 |                       |
      |                       | .. note::                                                                                                                                                                                                                                       |                       |
      |                       |                                                                                                                                                                                                                                                 |                       |
      |                       |    By default, the service port on each backend server is used. You can also specify a port for health checks.                                                                                                                                  |                       |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Path                  | Specifies the health check URL, which is the destination on backend servers for health checks. This parameter is mandatory if the health check protocol is HTTP or HTTPS.                                                                       | /index.html           |
      |                       |                                                                                                                                                                                                                                                 |                       |
      |                       | The path can contain 1 to 80 characters and must start with a slash (/).                                                                                                                                                                        |                       |
      |                       |                                                                                                                                                                                                                                                 |                       |
      |                       | The path can contain letters, digits, hyphens (-), slashes (/), periods (.), question marks (?), percent signs (%), ampersands (&), and underscores (_).                                                                                        |                       |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Interval (s)          | Specifies the maximum time between two consecutive health checks, in seconds.                                                                                                                                                                   | 5                     |
      |                       |                                                                                                                                                                                                                                                 |                       |
      |                       | The interval ranges from **1** to **50**.                                                                                                                                                                                                       |                       |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Timeout (s)           | Specifies the maximum time required for waiting for a response from the health check, in seconds. The interval ranges from **1** to **50**.                                                                                                     | 3                     |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Maximum Retries       | Specifies the maximum number of health check retries. The value ranges from **1** to **10**.                                                                                                                                                    | 3                     |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+

#. Click **Next**.

#. Confirm the specifications and click **Create Now**.

Related Operations
------------------

You can associate the backend server group with the listener of a dedicated load balancer in either ways listed in :ref:`Table 1 <elb_ug_hdg_0003__table15450757191418>`.

.. |image1| image:: /_static/images/en-us_image_0000001747739624.png
.. |image2| image:: /_static/images/en-us_image_0000001747739748.png
.. |image3| image:: /_static/images/en-us_image_0000001794660865.png
